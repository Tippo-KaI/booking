<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Danh sÃ¡ch tour</title>
  </head>

  <body>
    <h1>Danh sÃ¡ch Tour Du Lá»‹ch</h1>
    <a href="index.html">â• ThÃªm tour má»›i</a>

    <div id="tourList"></div>

    <script>
      const apiUrl = "http://localhost:5000/api/tour";
      const list = document.getElementById("tourList");

      async function loadTours() {
        list.innerHTML = "Äang táº£i danh sÃ¡ch...";
        try {
          const res = await fetch(apiUrl);
          const tours = await res.json();

          if (!res.ok) {
            list.innerHTML = "âŒ Lá»—i táº£i danh sÃ¡ch: " + (tours.message || "KhÃ´ng rÃµ nguyÃªn nhÃ¢n");
            return;
          }

          if (tours.length === 0) {
            list.innerHTML = "ğŸ“­ ChÆ°a cÃ³ tour nÃ o.";
            return;
          }

          list.innerHTML = tours.map(t => `
            <div style="border:1px solid #999; padding:10px; margin-bottom:10px;">
              <h3>${t.tenTour}</h3>
              <p>ğŸ“ Äá»‹a Ä‘iá»ƒm: ${t.diaDiem}</p>
              <p>ğŸ’° GiÃ¡: ${t.gia.toLocaleString()} VND</p>
              <p>ğŸ“… Khá»Ÿi hÃ nh: ${new Date(t.ngayKhoiHanh).toLocaleDateString("vi-VN")}</p>
              <p>ğŸ•’ Sá»‘ ngÃ y: ${t.soNgay}</p>
              <p>ğŸ‘¥ Sá»‘ khÃ¡ch tá»‘i Ä‘a: ${t.soLuongKhachToiDa}</p>
              <p>ğŸ¥— Ä‚n uá»‘ng: ${t.anUong}</p>
              <p>ğŸ—ºï¸ Khu vá»±c: ${t.khuVucThamQuan}</p>
              <p>ğŸ“ MÃ´ táº£: ${t.moTa || "(KhÃ´ng cÃ³)"}</p>
              <p>ğŸ“¸ áº¢nh:
                ${t.hinhAnh
                  ? `<img src="/uploads/${t.hinhAnh}" alt="${t.tenTour}" width="200"/>`
                  : "(ChÆ°a cÃ³ áº£nh)"}
              </p>
              <p>ğŸ“¦ Tráº¡ng thÃ¡i: ${t.daDay ? "âŒ ÄÃ£ Ä‘áº§y" : "âœ… CÃ²n chá»—"}</p>
              <button onclick="deleteTour('${t._id}')">ğŸ—‘ï¸ XÃ³a</button>
            </div>
          `).join("");
        } catch (err) {
          list.innerHTML = "âš ï¸ Lá»—i khi táº£i tour: " + err.message;
        }
      }

      async function deleteTour(id) {
        if (!confirm("Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a tour nÃ y khÃ´ng?")) return;
        try {
          const res = await fetch(`${apiUrl}/${id}`, { method: "DELETE" });
          const data = await res.json();
          alert(data.message || "ÄÃ£ xÃ³a tour!");
          loadTours();
        } catch (err) {
          alert("âŒ Lá»—i khi xÃ³a: " + err.message);
        }
      }

      loadTours();
    </script>
  </body>
</html>
